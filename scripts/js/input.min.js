$(document).ready(function(a){function g(){(d.hasChanged=d.val!==$("input").val())&&(d.val=$("input").val())}function h(a){var b=a?"50":"30";$("#contentWrapper").stop().animate({top:b+"%"},400,"linear",i(a))}function i(a){$("#webFrame").css("display",a?"none":"block")}function j(){"undefined"!=typeof b.data&&b.data.length>0&&b.isAdded===!1&&(l(),console.log(b.data),console.log(Object.prototype.toString.call(b.data)),n(b.data));var a=new Date;a.setDate(a.getDate()+b.expire),document.cookie=b.name+"="+b.data.toString()+"; expires = "+a+"; path = /;"}function k(){if(document.cookie.indexOf(b.name)>=0){var a=decodeURIComponent(document.cookie),c=a.indexOf(b.name)+b.name.length+1,a=a.substr(c);if(a.indexOf(";")>=0){var d=a.indexOf(";");a=a.substr(0,d)}return console.log(a),historyArray=a.split(";"),newCookieArray=Array(),new Array(a)}return[]}function l(a){if("[object String]"===Object.prototype.toString.call(b.data))b.data=b.data.split(",");else if("[object Array]"===Object.prototype.toString.call(b.data)&&"undefined"!=typeof b.data[0]){console.log(b.data),console.log(Object.prototype.toString.call(b.data[0]));for(var c=b.data[0],c=c.split(","),d=new Array,e=0;e<c.length;e+2)d.push(c.splice(e,2));b.data=d,console.log(d)}}function m(a){console.log(a),l(a),console.log(a),j(),console.log(b.data),n(a)}function n(a){b.isAdded===!1&&($.each(b.data,function(a,b){$("#historyPanel table").append("<tr><td>"+b[0]+'</td><td><input value="'+b[1]+'" /></td></tr>')}),b.isAdded=!0),$("#historyPanel table").append("<tr><td>"+a[0]+'</td><td><input value="'+a[1]+'" /></td></tr>')}function o(){b.elements.each(function(){$(this).removeClass("inactive")}),document.cookie=b.name+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path = /;",b.data=k(),console.log(b.data),j()}function p(a){$.post("scripts/php/getMeta.php",{url:a},function(a){console.log(a)})}var b={flag:!0,elements:$(".historyFeature"),name:"urlHistory",data:"",expire:7,isAdded:!1};b.flag&&o();var c={key:"AIzaSyBNkn6HVlq0AAy_rK1WnL2uJ4Upbqs0Yxw",host:"https://www.googleapis.com/urlshortener/v1/url?key=",contentType:"application.json",attempts:0,attemptsLimit:2},d={val:"",searchVal:"",isEmpty:!0,hasChanged:!1},e={state:d.isEmpty},f={active:!1,elements:$(".websiteInfo"),corProxy:"https://crossorigin.me/",title:"",description:"",author:"",copyright:"",keywords:""};f.active&&f.elements.removeClass("inactive"),$(document).on("click","input",function(){this.setSelectionRange(0,this.value.length)}),$("input").on("change paste input",function(a){var b=$(this).val();d.isEmpty="block"==$("#col-URL-defaultText").css("display",null!==b&&""!==b?"none":"block").css("display"),g(),d.hasChanged&&e.state!==d.isEmpty&&(e.state=!e.state,h(d.isEmpty))}),$("form").submit(function(a){function e(){var a=new XMLHttpRequest;a.open("POST",c.host+c.key,!0),a.setRequestHeader("Content-Type","application/json; charset=utf-8"),a.timeout=5e3;var i={key:c.key,longUrl:d.searchVal},j=JSON.stringify(i);a.onreadystatechange=function(){if(a.readyState==XMLHttpRequest.DONE){h("("+d.searchVal+")",!1),$("#col-shortUrl").addClass("greenBg, greenBGFlash");var c=JSON.parse(a.responseText);"undefined"==typeof c.id&&(c.id=d.searchVal),$("#shortUrl").val(c.id),$("#websiteInfoContainer").removeClass("inactive"),f.active&&p(d.searchVal),b.flag&&m([d.searchVal,c.id])}else a.readyState==XMLHttpRequest.OPENED?h("Working",!0):a.readyState==XMLHttpRequest.LOADING&&h("Almost done",!0)},a.ontimeout=function(b){a.abort(),c.attempts<=c.attemptsLimit?e():g()},a.send(j),c.attempts+=1}function g(){$("#shortUrl").val("Could not shorten URL, please try again")}function h(a,b){void 0!==a&&$("#loadingContainer span").html(a);var c=$("#loadingContainer img");void 0!==b&&c.css("display",b===!0?"block":"none"),a||b?$("#loadingContainer").css("display","block"):$("#loadingContainer").fadeOut(200)}a.preventDefault(),d.isEmpty||d.val!==d.searchVal&&(d.searchVal=d.val,$("iframe").stop().attr("src",d.searchVal),e())}),$(document).on("click",".panelOption",function(){$(".panelOption").each(function(){$(this).toggleClass("active")}),$(".panel").each(function(){$(this).toggleClass("hidden")})})});